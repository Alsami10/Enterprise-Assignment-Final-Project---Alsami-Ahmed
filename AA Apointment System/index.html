<doctype html>
    <html lang="en">
        <head>
            <img src="Main.png.png" alt=Doctor and patient at an appointment dashboard with interactive charts and graphs showing appointment data, visible text includes AA Appointment System and Book an Appointment, modern professional and welcoming design, environment is inviting and user friendly>
            <meta name="description" content="AA Appointment System - Book your appointment with top doctors and view interactive charts and graphs of appointment data.">
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Excel Dashboard and Booking System</title>
    
            <script src="scripts.js" defer></script>
            <link rel ="stylesheet" href="styles.css">
            <script defer src="scripts.js"></script>
            <script>
                fetch('/getusers')
                .then(response => response.json())
                .then(data => console.log(data));
                  <title> Google Sheets Chart</title>
    </script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script> </script></script>
      <script> type="text/javascript">
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);
function drawChart() {
    var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/https://docs.google.com/spreadsheets/d/e/2PACX-1vTjiMu9XPSXZkKXFY05wayb-IkyuyN9lNER4L1Uz1q3vmiEAAiM6WMzLZ8_Sb5kSZOUiEmvZ-tffTcr/pubhtml?gid=1646428372&single=true/gviz/tq?gid=0');
    query.send(handleQueryResponse);
}

function handleQueryResponse(response) {
    var data = response.getDataTable();
    var options = {
        title: 'Appointemtn data visualisation charts',
        hAxis: {title: 'X-axis'},
        vAxis: {title: 'Y-axis'},
        legend: { position: 'bottom' }
    };
    var chart = new google.visualization.BarChart(document.getElementById('chart_div'));
    charts.draw(data, options);
}

      </script>
      </head>
        <body>
            <h2>Live Charts</h2>
            <div id="chart_div" style="width:900px; height: 500px;"></div>
            </body>
           <div id="visualisation">
            <iframe src = "Appointment.csv.xlsx" width="800" height="600"></iframe>
            <canvas id="Appointment.csv.xlsx"></canvas>
           </div> 
           <div id="appointment">
            <h2>Book an Appointment</h2>
            <form id = "scripts.js" method="POST">
                <label for="Name">Name:</label>
                <input type="text" id="Name" name="customer_Name" required>
                
                <label for="specialty">select specialty:</label>
                <select id="specialty" name="specialty" required>
                    <option value="Cardiology">Cardiology</option>
                    <option value="Dermatology">Dermatology</option>
                    <option value="Neurology">Neurology</option>
                    <option value="Pediatrics">Pediatrics</option>
                    <option value="Psychiatry">Psychiatry</option>
                    <option value="Radiology">Radiology</option>
                <select>

                <label for="doctor">Select Doctor:</label>
                <select id="doctor" name="doctor" required>
                    <option value="Dr. Smith">Dr. Smith</option>

                    </select>
                <label for="date">Date:</label>
                <input type="date" id="date" name="appointment_date" required>
    
                <label for ="time">Time:</label>
                <input type="time" id="time" name="appointment_time" required>
                <button action="/book" type="submit">Book Appointment</button>
        
            </form>
             </div>
            <footer>
                <p>&copy; AA 2025 Top Doctors Appointment Booking System and data visualisation</p>
            <canvas id="Mychart"></canvas>
            <script>
             fetch('appointment.csv') // Load Excel data as csv
             .then(response=> response.text())
             .then(data => {
                const chartdata = processCSV(data); // Convert CSV to usable format
                new Chart(document.getElementById('Mychart'), {
                    type: 'bar',
                    data: chartdata
                });
            });
            </script>
        </head>
    </html>
</doctype>